<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulá tu ahorro · Quiroga GNC</title>

  <link rel="stylesheet" href="./css/style.css" />

  <style>
    body.simBody{
      margin:0;
      background:
        radial-gradient(1200px 700px at 15% 0%, rgba(255,193,7,.16), transparent 55%),
        radial-gradient(900px 600px at 85% 10%, rgba(107,228,255,.12), transparent 55%),
        radial-gradient(900px 700px at 40% 110%, rgba(255,255,255,.06), transparent 55%),
        #070a10;
      color: rgba(255,255,255,.92);
    }

    .simWrap{max-width:1100px; margin:0 auto; padding:24px}
    .simGrid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:16px;
      align-items:start;
      margin-top:18px;
    }
    @media (max-width: 920px){
      .simGrid{grid-template-columns:1fr}
      .simOrderInputs{order:1}
      .simOrderResults{order:2}
      .simOrderAction{order:3}
    }

    .simCard{
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      border-radius:18px;
      box-shadow:0 18px 50px rgba(0,0,0,.45);
      overflow:hidden;
    }
    .simCardHeader{
      padding:18px 18px 12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background:linear-gradient(180deg, rgba(255,255,255,.06), transparent);
    }
    .simCardHeader h2{margin:0; font-size:18px; color:rgba(255,255,255,.92)}
    .simCardHeader p{margin:6px 0 0; font-size:13px; color:rgba(255,255,255,.72); line-height:1.35}
    .simCardBody{padding:18px}

    .simRow{display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin:10px 0 6px}
    .simLabel{display:block; font-size:12px; color:rgba(255,255,255,.72); margin:0 0 6px}
    .simInput{
      width:100%;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.18);
      color:rgba(255,255,255,.92);
      outline:none;
    }

    .simFormGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    @media (max-width: 720px){ .simFormGrid{grid-template-columns:1fr} }

    .simSliderBox{
      padding:14px;
      border-radius:16px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      margin-top:10px;
    }
    .simSliderTop{
      display:flex; align-items:baseline; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }
    .simKmBig{font-size:28px; font-weight:1000; letter-spacing:.2px}
    .simKmBig span{color:#FFC107}
    .simMini{font-size:12px; color:rgba(255,255,255,.62)}

    .simRange{width:100%; margin-top:10px; accent-color:#FFC107}
    .simTicks{
      display:flex; justify-content:space-between;
      margin-top:8px;
      font-size:11px;
      color:rgba(255,255,255,.55);
    }

    .simWarn{
      margin-top:12px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,193,7,.22);
      background:rgba(255,193,7,.10);
      color:rgba(255,255,255,.80);
      font-size:12px;
      line-height:1.35;
      display:none;
    }

    .simKpis{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top:0;
    }
    @media (max-width: 720px){ .simKpis{grid-template-columns:1fr} }

    .simKpi{
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      border-radius:16px;
      padding:14px;
    }
    .simKpiLabel{font-size:12px; color:rgba(255,255,255,.72)}
    .simKpiValue{font-size:22px; font-weight:1000; margin-top:6px}
    .simKpiNote{font-size:12px; color:rgba(255,255,255,.62); margin-top:6px}
    .simBlue .simKpiValue{color:rgba(107,228,255,.95)}
    .simAccent .simKpiValue{color:#FFC107}
    .simOk .simKpiValue{color:#7CFF7A}
    .simBad .simKpiValue{color:#ff5b5b}

    .simBars{margin-top:14px; display:grid; gap:10px}
    .simBar{
      background:rgba(0,0,0,.16);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      overflow:hidden;
    }
    .simBarTop{
      display:flex; justify-content:space-between; align-items:center;
      padding:10px 12px;
      font-size:12px;
      color:rgba(255,255,255,.75);
    }
    .simFill{height:10px; width:0%; transition:width .35s ease; background:rgba(255,255,255,.18)}
    .simFillNafta{background:rgba(107,228,255,.55)}
    .simFillGnc{background:rgba(255,193,7,.70)}

    .simSideStack{display:flex; flex-direction:column; gap:16px}

    .simFoot{
      margin-top:14px;
      color:rgba(255,255,255,.62);
      font-size:12px;
      line-height:1.35;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      justify-content:space-between;
      align-items:center;
    }
    .simFoot a{color:rgba(255,255,255,.85)}

    /* Botón volver: usa .btn de tu CSS, esto solo ajusta tamaño en mobile */
    .simBackRow{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .simBackRow .btn{white-space:nowrap}
    @media (max-width: 720px){
      .simBackRow .btn{padding:10px 12px}
    }
  </style>
</head>

<body class="simBody">

  <header class="siteHeader">
    <div class="wrap">
      <div class="topbar">

        <!-- LOGO CLICKEABLE: vuelve al index -->
        <a class="brand" href="./index.html" aria-label="Volver al inicio">
          <img class="brandLogo" src="./cropped-quirgrouplogo-200x56 (1).png" alt="Quirgroup GNC" />
        </a>

        <nav id="nav" class="mainNav" aria-label="Navegación principal">
          <a href="./index.html#equipos">EQUIPOS</a>
          <a href="./index.html#cotizacion">COTIZACIÓN</a>
          <a href="./index.html#instalaciones">INSTALACIONES</a>
          <a href="./index.html#servicios">REPARACIONES</a>
          <a href="./index.html#contacto">CONTACTO</a>
        </nav>

        <a class="btn" href="https://wa.me/5493512174455?text=Hola%20quiero%20sacar%20turno" target="_blank" rel="noopener">
          SOLICITÁ TU TURNO
        </a>
      </div>
    </div>
  </header>

  <main class="simWrap">
    <div class="simGrid">

      <!-- IZQUIERDA: INPUTS -->
      <section class="simCard simOrderInputs" aria-label="Simulador">
        <div class="simCardHeader">
          <div class="simBackRow">
            <!-- BOTÓN VOLVER -->
            <a class="btn secondary" href="./index.html" aria-label="Volver a la página principal">VOLVER</a>
            <div>
              <h2 style="margin:0">Simulador de ahorro</h2>
              <p style="margin:6px 0 0">Mové la barra de km y compará Nafta vs GNC.</p>
            </div>
          </div>
        </div>

        <div class="simCardBody">
          <div class="simSliderBox">
            <div class="simSliderTop">
              <div class="simKmBig"><span id="kmOut">500</span> km</div>
              <div class="simMini" id="kmNote">ida y vuelta</div>
            </div>

            <input id="kmRange" class="simRange" type="range" min="0" max="5000" step="50" value="500" />

            <div class="simTicks">
              <span>0</span><span>1250</span><span>2500</span><span>3750</span><span>5000+</span>
            </div>

            <div class="simRow" style="margin:10px 0 0">
              <div style="flex:1;min-width:220px">
                <label class="simLabel" for="viajes">Cantidad de viajes (opcional)</label>
                <input class="simInput" id="viajes" type="number" min="1" step="1" inputmode="numeric" placeholder="Ej: 4" />
              </div>
              <div style="flex:1;min-width:220px">
                <label class="simLabel" for="kmManual">Editar km manual (opcional)</label>
                <input class="simInput" id="kmManual" type="text" inputmode="numeric" placeholder="Ej: 1.200" />
              </div>
            </div>
          </div>

          <div class="simFormGrid">
            <div>
              <label class="simLabel" for="naftaPrecio">Precio Nafta ($/L)</label>
              <input class="simInput" id="naftaPrecio" type="number" min="0" step="0.01" inputmode="decimal" />
            </div>
            <div>
              <label class="simLabel" for="naftaCons">Consumo Nafta (L/100km)</label>
              <input class="simInput" id="naftaCons" type="number" min="0" step="0.1" inputmode="decimal" />
            </div>
            <div>
              <label class="simLabel" for="gncPrecio">Precio GNC ($/m³)</label>
              <input class="simInput" id="gncPrecio" type="number" min="0" step="0.01" inputmode="decimal" />
            </div>
            <div>
              <label class="simLabel" for="gncCons">Consumo GNC (m³/100km)</label>
              <input class="simInput" id="gncCons" type="number" min="0" step="0.1" inputmode="decimal" />
            </div>
          </div>

          <div class="simRow" style="margin-top:12px">
            <button class="btn" id="btnCalc" type="button">CALCULAR</button>
            <button class="btn secondary" id="btnReset" type="button">RESET</button>
            <span class="simMini">Se guarda en este navegador</span>
          </div>

          <div id="warnBox" class="simWarn"></div>
        </div>
      </section>

      <!-- DERECHA: RESULTADOS + CTA -->
      <aside class="simSideStack">

        <section class="simCard simOrderResults" aria-label="Resultados">
          <div class="simCardHeader">
            <h2>Resultados</h2>
            <p>Comparación clara para decidir rápido.</p>
          </div>

          <div class="simCardBody">
            <div class="simKpis">
              <div class="simKpi simBlue">
                <div class="simKpiLabel">Costo a Nafta</div>
                <div class="simKpiValue" id="outNafta">$0</div>
                <div class="simKpiNote" id="outNaftaNote">—</div>
              </div>
              <div class="simKpi simAccent">
                <div class="simKpiLabel">Costo a GNC</div>
                <div class="simKpiValue" id="outGnc">$0</div>
                <div class="simKpiNote" id="outGncNote">—</div>
              </div>
              <div class="simKpi simOk" id="kpiSave">
                <div class="simKpiLabel">Ahorro estimado</div>
                <div class="simKpiValue" id="outAhorro">$0</div>
                <div class="simKpiNote" id="outAhorroNote">—</div>
              </div>
              <div class="simKpi" id="kpiPct">
                <div class="simKpiLabel">% de ahorro</div>
                <div class="simKpiValue" id="outPct">0%</div>
                <div class="simKpiNote" id="outPctNote">—</div>
              </div>
            </div>

            <div class="simBars" aria-label="Comparación visual">
              <div class="simBar">
                <div class="simBarTop"><span>Nafta</span><b id="barNaftaVal">$0</b></div>
                <div class="simFill simFillNafta" id="barNafta"></div>
              </div>
              <div class="simBar">
                <div class="simBarTop"><span>GNC</span><b id="barGncVal">$0</b></div>
                <div class="simFill simFillGnc" id="barGnc"></div>
              </div>
            </div>

            <div class="simFoot">
              <span>Estimación orientativa. El consumo real depende del auto y el uso.</span>
              <a href="https://wa.me/5493512174455?text=Hola%20Hago%20____%20km%20por%20semana%20y%20tengo%20____.%20Quiero%20cotizar%20GNC" target="_blank" rel="noopener">
                Pedir cotización por WhatsApp
              </a>
            </div>
          </div>
        </section>

        <section class="simCard simOrderAction" aria-label="Acción">
          <div class="simCardHeader">
            <h2>¿Querés que te lo calculemos con tu auto?</h2>
            <p>Mandá modelo + km por semana y te damos una estimación mejor.</p>
          </div>
          <div class="simCardBody">
            <a class="btn" style="width:100%;justify-content:center"
              href="https://wa.me/5493512174455?text=Hola%20tengo%20____%20y%20hago%20____%20km%20por%20semana.%20Quiero%20una%20estimaci%C3%B3n%20de%20ahorro%20y%20cotizaci%C3%B3n."
              target="_blank" rel="noopener">
              ENVIAR DATOS POR WHATSAPP
            </a>
          </div>
        </section>

      </aside>
    </div>
  </main>

  <footer id="contacto">
    <div class="wrap">
      <div class="foot">
        <div>
          <strong>QUIROGA GNC</strong>
          <small>
            Córdoba, Argentina.<br>
            Horarios: Lun a Vie 08:00 a 18:00.
          </small>
        </div>

        <div>
          <strong>Sedes</strong>
          <small>
            <b>Av. Leandro N. Alem 642</b>, X5001HYR Córdoba<br>
            <b>Domingo Zípoli 176</b>, X5000 Córdoba
          </small>
        </div>

        <div>
          <strong>Contacto</strong>
          <small>
            Teléfono / WhatsApp: <a href="tel:+543512174455">0351 217-4455</a><br>
            <a href="https://wa.me/5493512174455?text=Hola%20quiero%20sacar%20turno" target="_blank" rel="noopener">Escribir por WhatsApp</a>
          </small>
        </div>
      </div>
    </div>
  </footer>

  <script>
    const $ = (id)=>document.getElementById(id);
    const STORAGE_KEY = "qgnc_slider_ahorro_v1";
    const KM_MAX = 5000;
    const KM_STEP = 50;

    const fmtARS = (n) => {
      if (!isFinite(n)) return "—";
      return new Intl.NumberFormat("es-AR", { style:"currency", currency:"ARS", maximumFractionDigits:0 }).format(n);
    };
    const fmtNum = (n, d=1) => {
      if (!isFinite(n)) return "—";
      return new Intl.NumberFormat("es-AR", { minimumFractionDigits:d, maximumFractionDigits:d }).format(n);
    };

    function animateNumber(el, to, ms=420){
      const from = parseFloat((el.dataset.val || "0"));
      const start = performance.now();
      const step = (t)=>{
        const p = Math.min(1, (t-start)/ms);
        const v = from + (to-from) * (1 - Math.pow(1-p, 3));
        el.dataset.val = String(v);
        el.textContent = fmtARS(v);
        if (p < 1) requestAnimationFrame(step);
      };
      requestAnimationFrame(step);
    }

    function setWarn(msg){
      const box = $("warnBox");
      if (!msg){
        box.style.display = "none";
        box.textContent = "";
        return;
      }
      box.style.display = "block";
      box.textContent = msg;
    }

    function read(){
      const km = parseFloat($("kmRange").value || "0");
      const viajesRaw = $("viajes").value.trim();
      const viajes = viajesRaw ? Math.max(1, parseInt(viajesRaw,10)) : 1;

      const naftaPrecio = parseFloat($("naftaPrecio").value || "0");
      const naftaCons = parseFloat($("naftaCons").value || "0");
      const gncPrecio = parseFloat($("gncPrecio").value || "0");
      const gncCons = parseFloat($("gncCons").value || "0");

      return { km, viajes, naftaPrecio, naftaCons, gncPrecio, gncCons };
    }

    function calc(){
      const d = read();

      $("kmOut").textContent = fmtNum(d.km,0);

      const missing = [];
      if (!(d.naftaPrecio > 0)) missing.push("precio nafta");
      if (!(d.naftaCons > 0)) missing.push("consumo nafta");
      if (!(d.gncPrecio > 0)) missing.push("precio GNC");
      if (!(d.gncCons > 0)) missing.push("consumo GNC");

      if (missing.length) setWarn("Completá: " + missing.join(", ") + ".");
      else setWarn("");

      const kmTotal = d.km * d.viajes;

      const litros = (kmTotal/100) * d.naftaCons;
      const m3 = (kmTotal/100) * d.gncCons;

      const costoNafta = litros * d.naftaPrecio;
      const costoGnc = m3 * d.gncPrecio;
      const ahorro = costoNafta - costoGnc;

      let pct = 0;
      if (costoNafta > 0) pct = (ahorro / costoNafta) * 100;

      animateNumber($("outNafta"), isFinite(costoNafta)?costoNafta:0);
      animateNumber($("outGnc"), isFinite(costoGnc)?costoGnc:0);
      animateNumber($("outAhorro"), isFinite(ahorro)?ahorro:0);

      $("outNaftaNote").textContent = `${fmtNum(litros,1)} L · ${fmtNum(kmTotal,0)} km`;
      $("outGncNote").textContent = `${fmtNum(m3,1)} m³ · ${fmtNum(kmTotal,0)} km`;

      $("outPct").textContent = (isFinite(pct) ? fmtNum(pct,0) : "0") + "%";

      const kpiPct = $("kpiPct");
      const kpiSave = $("kpiSave");
      kpiPct.classList.remove("simOk","simBad");
      kpiSave.classList.remove("simOk","simBad");

      if (ahorro > 0){
        kpiPct.classList.add("simOk");
        kpiSave.classList.add("simOk");
        $("outPctNote").textContent = "Ahorro estimado vs nafta.";
        $("outAhorroNote").textContent = "Esto es lo que te queda en el bolsillo.";
      } else if (ahorro < 0){
        kpiPct.classList.add("simBad");
        kpiSave.classList.add("simBad");
        $("outPctNote").textContent = "Con estos valores no conviene (revisar consumos/precios).";
        $("outAhorroNote").textContent = "Revisá consumo o precios cargados.";
      } else {
        $("outPctNote").textContent = "Sin diferencia con estos valores.";
        $("outAhorroNote").textContent = "—";
      }

      const max = Math.max(costoNafta, costoGnc, 1);
      $("barNafta").style.width = (costoNafta/max*100) + "%";
      $("barGnc").style.width = (costoGnc/max*100) + "%";
      $("barNaftaVal").textContent = fmtARS(costoNafta);
      $("barGncVal").textContent = fmtARS(costoGnc);

      save(d);
    }

    function save(d){
      try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); }catch(e){}
    }

    function load(){
      const defaults = {
        km: 500,
        viajes: "",
        naftaPrecio: 1200,
        naftaCons: 8.5,
        gncPrecio: 550,
        gncCons: 9.5
      };
      let d = defaults;
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if (raw) d = Object.assign({}, defaults, JSON.parse(raw));
      }catch(e){}

      $("kmRange").value = d.km ?? 500;
      $("viajes").value = d.viajes ?? "";
      $("naftaPrecio").value = d.naftaPrecio ?? 1200;
      $("naftaCons").value = d.naftaCons ?? 8.5;
      $("gncPrecio").value = d.gncPrecio ?? 550;
      $("gncCons").value = d.gncCons ?? 9.5;

      $("kmOut").textContent = fmtNum(parseFloat($("kmRange").value),0);
      $("kmManual").value = String($("kmRange").value);

      calc();
    }

    function resetAll(){
      localStorage.removeItem(STORAGE_KEY);
      $("kmRange").value = 500;
      $("viajes").value = "";
      $("naftaPrecio").value = 1200;
      $("naftaCons").value = 8.5;
      $("gncPrecio").value = 550;
      $("gncCons").value = 9.5;
      $("kmManual").value = "500";
      setWarn("");
      calc();
    }

    $("kmRange").addEventListener("input", ()=>{
      $("kmManual").value = $("kmRange").value;
      calc();
    });

    $("kmManual").addEventListener("input", ()=>{
      const raw = ($("kmManual").value || "").toString();
      const cleaned = raw.replace(/[^\d]/g, "");
      if (cleaned === "") return;

      const v = parseInt(cleaned, 10);
      if (!isFinite(v)) return;

      const snapped = Math.round(v / KM_STEP) * KM_STEP;
      const clamped = Math.max(0, Math.min(KM_MAX, snapped));

      $("kmRange").value = clamped;
      calc();
    });

    let t = null;
    ["viajes","naftaPrecio","naftaCons","gncPrecio","gncCons"].forEach(id=>{
      $(id).addEventListener("input", ()=>{
        clearTimeout(t);
        t = setTimeout(calc, 140);
      });
    });

    $("btnCalc").addEventListener("click", calc);
    $("btnReset").addEventListener("click", resetAll);

    load();
  </script>
</body>
</html>
